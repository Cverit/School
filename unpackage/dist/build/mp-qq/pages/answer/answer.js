(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/answer/answer"],{1321:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n("66fd")),a=n("2f62");function i(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},s=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),s.forEach(function(t){r(e,t,n[t])})}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={data:function(){return{display:!1,answer_id:0,scroll_height:700,answerInfo:[],imageList:[],isInput:!1,inputComment:"",comment_page:1,scroll_top:0,showToast:!1,toastContent:"",fixedHeight:0,loading:!1}},computed:o({hasComment:function(){return 0!=this.answerInfo.length&&0!=this.answerInfo.answer_comments.length}},(0,a.mapState)({user:function(e){return e.AuthUser}})),onShareAppMessage:function(e){return{title:"快来围观这个回答",path:"/pages/answer/answer?answer_id="+this.answer_id,imageUrl:"/static/user/shareImage.jpg"}},onLoad:function(t){var n=this;this.answer_id=t.answer_id;this.loading=!0,s.default.prototype.$http.request({url:"/answers/detail",method:"POST",params:{answer_id:this.answer_id}}).then(function(s){for(var a in n.answerInfo=s.data.data,n.answerInfo.answer_images)n.imageList.push(n.answerInfo.answer_images[a].image_url);for(var i in n.formatAnswerContent(),n.formatTime(),n.answerInfo.answer_comments)n.formatCommentsTime(i);setTimeout(function(){if(n.getHeight(),1==t.comment){var s=e.createSelectorQuery().in(n);s.select("#comment").boundingClientRect(function(e){n.scroll_top=e.top}).exec()}n.loading=!1},200)})},mounted:function(){var e=this;setTimeout(function(){e.display=!0},100)},methods:{navigateTopic:function(t){e.navigateTo({url:"/pages/topic/topic?topic_id="+t})},navigateUserShow:function(t,n){n||e.navigateTo({url:"/pages/user-show/user-show?user_id="+t})},changeFixedHeight:function(e){this.fixedHeight=e.detail.height},hideModal:function(e){this.showToast=!1},formatAnswerContent:function(){this.answerInfo.answer_content=this.answerInfo.answer_content.replace(/<br\/\>/g,"\n")},tooglrUserFollow:function(){var e=this;s.default.prototype.$http.request({url:"/users/follow",method:"POST",params:{accept_id:this.answerInfo.answer_user.user_id}}).then(function(t){e.answerInfo.user_follow=!e.answerInfo.user_follow,e.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},displayMoreComments:function(){this.comment_page++},likeComment:function(e,t){var n=this;s.default.prototype.$http.request({url:"/likes/comment",method:"POST",params:{comment_id:t}}).then(function(t){n.answerInfo.answer_comments[e].comment_like=!n.answerInfo.answer_comments[e].comment_like,n.answerInfo.answer_comments[e].comment_like?n.answerInfo.answer_comments[e].comment_likes++:n.answerInfo.answer_comments[e].comment_likes--,n.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},submitComment:function(){var e=this;""==this.inputComment&&this.$refs.notification.open({type:"warn",content:"留言不能为空～",timeout:1500,isClick:!1}),s.default.prototype.$http.request({url:"/comments/answer/create",method:"POST",params:{answer_id:this.answer_id,comment_content:this.inputComment,parent_id:0}}).then(function(t){e.answerInfo.answer_comments.unshift(t.data.data),e.formatCommentsTime(0),e.inputComment="",e.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})}),this.cancelInput()},beginInput:function(){if(""==this.user.authentication||null==this.user.authentication)return this.toastContent="先去认证身份，再进行留言操作～～",void(this.showToast=!0);this.isInput=!0},cancelInput:function(){this.isInput=!1,this.fixedHeight=0},likeAnswer:function(e,t){var n=this;s.default.prototype.$http.request({url:"/likes/answer",method:"POST",params:{answer_id:this.answer_id}}).then(function(e){n.answerInfo.answer_like=!n.answerInfo.answer_like,n.answerInfo.answer_like?n.answerInfo.answer_likes++:n.answerInfo.answer_likes--,n.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},CollectAnswer:function(e,t){var n=this;s.default.prototype.$http.request({url:"/collections/answer",method:"POST",params:{answer_id:this.answer_id}}).then(function(e){n.answerInfo.answer_collect=!n.answerInfo.answer_collect,n.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},viewImage:function(t){e.previewImage({urls:this.imageList,current:t.currentTarget.dataset.url})},getHeight:function(){var t=this;e.getSystemInfo({success:function(n){t.screen_height=n.windowHeight,t.screen_width=n.windowWidth;var s=e.createSelectorQuery().in(t);s.select("#scroll").boundingClientRect(function(e){t.scroll_height=t.screen_height-e.top-50}).exec()}})},formatTime:function(){var e=this.answerInfo.answer_created.split(" "),t=(new Date).toLocaleDateString(),n=Math.abs(Math.ceil((new Date(t)-new Date(e[0]))/864e5)),s=7-n;if(0===n)this.answerInfo.display_time="今天 "+e[1];else if(1===n)this.answerInfo.display_time="昨天 "+e[1];else if(2===n)this.answerInfo.display_time="前天 "+e[1];else if(s>0){var a=new Date(this.answerInfo.answer_created).getDay();switch(a){case 0:this.answerInfo.display_time="星期天 "+e[1];break;case 1:this.answerInfo.display_time="星期一 "+e[1];break;case 2:this.answerInfo.display_time="星期二 "+e[1];break;case 3:this.answerInfo.display_time="星期三 "+e[1];break;case 4:this.answerInfo.display_time="星期四 "+e[1];break;case 5:this.answerInfo.display_time="星期五 "+e[1];break;case 6:this.answerInfo.display_time="星期六 "+e[1];break}}else this.answerInfo.display_time=this.answerInfo.answer_created},formatCommentsTime:function(e){var t=this.answerInfo.answer_comments[e].comment_created.split(" "),n=(new Date).toLocaleDateString(),s=Math.abs(Math.ceil((new Date(n)-new Date(t[0]))/864e5)),a=7-s;if(0===s)this.answerInfo.answer_comments[e].display_time="今天 "+t[1];else if(1===s)this.answerInfo.answer_comments[e].display_time="昨天 "+t[1];else if(2===s)this.answerInfo.answer_comments[e].display_time="前天 "+t[1];else if(a>0){var i=new Date(this.answerInfo.answer_comments[e].comment_created).getDay();switch(i){case 0:this.answerInfo.answer_comments[e].display_time="星期天 "+t[1];break;case 1:this.answerInfo.answer_comments[e].display_time="星期一 "+t[1];break;case 2:this.answerInfo.answer_comments[e].display_time="星期二 "+t[1];break;case 3:this.answerInfo.answer_comments[e].display_time="星期三 "+t[1];break;case 4:this.answerInfo.answer_comments[e].display_time="星期四 "+t[1];break;case 5:this.answerInfo.answer_comments[e].display_time="星期五 "+t[1];break;case 6:this.answerInfo.answer_comments[e].display_time="星期六 "+t[1];break}}else this.answerInfo.answer_comments[e].display_time=this.answerInfo.answer_comments[e].comment_created}}};t.default=c}).call(this,n("a821")["default"])},"3bb1":function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return s}),n.d(t,"b",function(){return a})},"885f":function(e,t,n){"use strict";n.r(t);var s=n("1321"),a=n.n(s);for(var i in s)"default"!==i&&function(e){n.d(t,e,function(){return s[e]})}(i);t["default"]=a.a},b544:function(e,t,n){"use strict";(function(e){n("499b"),n("921b");s(n("66fd"));var t=s(n("dcb4"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("a821")["createPage"])},dcb4:function(e,t,n){"use strict";n.r(t);var s=n("3bb1"),a=n("885f");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n("5973");var o=n("2877"),r=Object(o["a"])(a["default"],s["a"],s["b"],!1,null,null,null);t["default"]=r.exports}},[["b544","common/runtime","common/vendor"]]]);