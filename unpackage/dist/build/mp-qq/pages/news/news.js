(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/news/news","components/waterfall-flow/waterfall-flow"],{"0df9":function(e,t,n){"use strict";(function(e){n("499b"),n("921b");s(n("66fd"));var t=s(n("1d9b"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("a821")["createPage"])},"1d9b":function(e,t,n){"use strict";n.r(t);var s=n("c7c7"),i=n("e264");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("1c05");var a=n("2877"),c=Object(a["a"])(i["default"],s["a"],s["b"],!1,null,null,null);t["default"]=c.exports},"74b4":function(e,t,n){},c2d9:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={props:{list:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},init:{type:Boolean,default:!1},align:{type:Boolean,default:!1}},data:function(){return{mark:0,newList:[],boxHeight:[],top:[],left:[],loadingTop:0,display:!1}},watch:{list:function(e,t){this.mark=t.length,e!=t&&(this.newList=this.list,this.$nextTick(function(){var e=this;setTimeout(function(){e.display=!0},280),setTimeout(function(){e.waterFall()},300)}))},init:function(e,t){var n=this;this.mark=0,this.newList=[],this.boxHeight=[],this.top=[],this.left=[],this.loadingTop=0,this.display=!1,setTimeout(function(){n.display=!0},270)}},methods:{waterFall:function(){var t=this,n=e.createSelectorQuery().in(this);n.selectAll(".commodityItem").boundingClientRect(function(e){for(var n=t.newList.length,s=0,i=t.mark;i<n;i++)if(s=e[i].height,i<2)t.$set(t.newList[i],"top",0),t.$set(t.newList[i],"left",i),t.boxHeight.push(s),t.top.push(0),t.left.push(i);else{var o=t.boxHeight[0],a=0;o>t.boxHeight[1]&&(o=t.boxHeight[1],a=1),t.boxHeight[a]=o+s+5,t.top.push(o+5),t.left.push(a),t.$set(t.newList[i],"top",o+5),t.$set(t.newList[i],"left",a),t.loadingTop=t.boxHeight[a]}}).exec()},choose:function(e){this.$emit("click",e)},navigateUserShow:function(t){e.navigateTo({url:"/pages/user-show/user-show?user_id="+t})}}};t.default=n}).call(this,n("a821")["default"])},c7c7:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"a",function(){return s}),n.d(t,"b",function(){return i})},da7f:function(e,t,n){"use strict";var s=n("74b4"),i=n.n(s);i.a},e264:function(e,t,n){"use strict";n.r(t);var s=n("ec8f"),i=n.n(s);for(var o in s)"default"!==o&&function(e){n.d(t,e,function(){return s[e]})}(o);t["default"]=i.a},ec8f:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n("66fd")),i=n("2f62"),o=a(n("60c5"));a(n("feaa"));function a(e){return e&&e.__esModule?e:{default:e}}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},s=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),s.forEach(function(t){r(e,t,n[t])})}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}new o.default({key:"QL7BZ-ZCJKK-72IJS-A6NA6-HRJ3F-ZYB6J"});var f={data:function(){return{display:!1,news_id:0,scroll_height:700,newsInfo:[],imageList:[],isInput:!1,inputComment:"",comment_page:1,scroll_top:0,showToast:!1,toastContent:"",fixedHeight:0,loading:!1}},computed:c({hasComment:function(){return 0!=this.newsInfo.length&&0!=this.newsInfo.news_comments.length}},(0,i.mapState)({user:function(e){return e.AuthUser}})),onShareAppMessage:function(e){return{title:"快来围观这条新闻",path:"/pages/news/news?news_id="+this.news_id,imageUrl:"/static/user/shareImage.jpg"}},onLoad:function(t){var n=this;this.news_id=t.news_id;this.loading=!0,s.default.prototype.$http.request({url:"/news/detail",method:"POST",params:{news_id:this.news_id}}).then(function(s){for(var i in n.newsInfo=s.data.data,n.newsInfo.news_images)n.imageList.push(n.newsInfo.news_images[i].image_url);for(var o in n.newsInfo.news_comments)n.formatCommentsTime(o);setTimeout(function(){if(n.getHeight(),1==t.comment){var s=e.createSelectorQuery().in(n);s.select("#comment").boundingClientRect(function(e){n.scroll_top=e.top}).exec()}n.loading=!1},200)})},mounted:function(){var e=this;setTimeout(function(){e.display=!0},100)},methods:{hideModal:function(e){this.showToast=!1},displayMoreComments:function(){this.comment_page++},likeComment:function(e,t){var n=this;s.default.prototype.$http.request({url:"/likes/comment",method:"POST",params:{comment_id:t}}).then(function(t){n.newsInfo.news_comments[e].comment_like=!n.newsInfo.news_comments[e].comment_like,n.newsInfo.news_comments[e].comment_like?n.newsInfo.news_comments[e].comment_likes++:n.newsInfo.news_comments[e].comment_likes--,n.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},submitComment:function(){var e=this;""==this.inputComment&&this.$refs.notification.open({type:"warn",content:"留言不能为空～",timeout:1500,isClick:!1}),s.default.prototype.$http.request({url:"/comments/news/create",method:"POST",params:{news_id:this.news_id,comment_content:this.inputComment,parent_id:0}}).then(function(t){e.newsInfo.news_comments.unshift(t.data.data),e.formatCommentsTime(0),e.inputComment="",e.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})}),this.cancelInput()},beginInput:function(){if(""==this.user.authentication||null==this.user.authentication)return this.toastContent="先去认证身份，再进行留言操作～～",void(this.showToast=!0);this.isInput=!0},cancelInput:function(){this.isInput=!1,this.fixedHeight=0},likeNews:function(e,t){var n=this;s.default.prototype.$http.request({url:"/likes/news",method:"POST",params:{news_id:this.news_id}}).then(function(e){n.newsInfo.news_like=!n.newsInfo.news_like,n.newsInfo.news_like?n.newsInfo.news_likes++:n.newsInfo.news_likes--,n.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},CollectNews:function(e,t){var n=this;s.default.prototype.$http.request({url:"/collections/news",method:"POST",params:{news_id:this.news_id}}).then(function(e){n.newsInfo.news_collect=!n.newsInfo.news_collect,n.$refs.notification.open({type:"success",content:"操作成功",timeout:1500,isClick:!1})})},viewImage:function(t){e.previewImage({urls:this.imageList,current:t.currentTarget.dataset.url})},getHeight:function(){var t=this;e.getSystemInfo({success:function(n){t.screen_height=n.windowHeight,t.screen_width=n.windowWidth;var s=e.createSelectorQuery().in(t);s.select("#scroll").boundingClientRect(function(e){t.scroll_height=t.screen_height-e.top-50}).exec()}})},formatTime:function(){var e=this.newsInfo.news_created.split(" "),t=(new Date).toLocaleDateString(),n=Math.abs(Math.ceil((new Date(t)-new Date(e[0]))/864e5)),s=7-n;if(0===n)this.newsInfo.display_time="今天 "+e[1];else if(1===n)this.newsInfo.display_time="昨天 "+e[1];else if(2===n)this.newsInfo.display_time="前天 "+e[1];else if(s>0){var i=new Date(this.newsInfo.news_created).getDay();switch(i){case 0:this.newsInfo.display_time="星期天 "+e[1];break;case 1:this.newsInfo.display_time="星期一 "+e[1];break;case 2:this.newsInfo.display_time="星期二 "+e[1];break;case 3:this.newsInfo.display_time="星期三 "+e[1];break;case 4:this.newsInfo.display_time="星期四 "+e[1];break;case 5:this.newsInfo.display_time="星期五 "+e[1];break;case 6:this.newsInfo.display_time="星期六 "+e[1];break}}else this.newsInfo.display_time=this.newsInfo.news_created},formatCommentsTime:function(e){var t=this.newsInfo.news_comments[e].comment_created.split(" "),n=(new Date).toLocaleDateString(),s=Math.abs(Math.ceil((new Date(n)-new Date(t[0]))/864e5)),i=7-s;if(0===s)this.newsInfo.news_comments[e].display_time="今天 "+t[1];else if(1===s)this.newsInfo.news_comments[e].display_time="昨天 "+t[1];else if(2===s)this.newsInfo.news_comments[e].display_time="前天 "+t[1];else if(i>0){var o=new Date(this.newsInfo.news_comments[e].comment_created).getDay();switch(o){case 0:this.newsInfo.news_comments[e].display_time="星期天 "+t[1];break;case 1:this.newsInfo.news_comments[e].display_time="星期一 "+t[1];break;case 2:this.newsInfo.news_comments[e].display_time="星期二 "+t[1];break;case 3:this.newsInfo.news_comments[e].display_time="星期三 "+t[1];break;case 4:this.newsInfo.news_comments[e].display_time="星期四 "+t[1];break;case 5:this.newsInfo.news_comments[e].display_time="星期五 "+t[1];break;case 6:this.newsInfo.news_comments[e].display_time="星期六 "+t[1];break}}else this.newsInfo.news_comments[e].display_time=this.newsInfo.news_comments[e].comment_created}}};t.default=f}).call(this,n("a821")["default"])},f781:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"a",function(){return s}),n.d(t,"b",function(){return i})},fb91:function(e,t,n){"use strict";n.r(t);var s=n("c2d9"),i=n.n(s);for(var o in s)"default"!==o&&function(e){n.d(t,e,function(){return s[e]})}(o);t["default"]=i.a},feaa:function(e,t,n){"use strict";n.r(t);var s=n("f781"),i=n("fb91");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("da7f");var a=n("2877"),c=Object(a["a"])(i["default"],s["a"],s["b"],!1,null,"21f54146",null);t["default"]=c.exports}},[["0df9","common/runtime","common/vendor"]]]);